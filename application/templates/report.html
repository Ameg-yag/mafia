<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/static/favicon.png" type="image/png" sizes="16x16">
    
    <script src="/static/external/jquery-1.12.4.js"></script>
    <script src="/static/external/jquery.dataTables.min.js"></script>
    <link href="/static/external/jquery.dataTables.min.css" rel="stylesheet" type="text/css">
    
    <title>Scan Report</title>

    <!-- Bootstrap Core CSS -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/external/bootstrap.min.css">
    <script src="/static/external/run_prettify.js"></script>
    <script src="/static/external/bootstrap.min.js"></script>
    <script src="/static/external/amcharts.js"></script>
    <script src="/static/external/serial.js"></script>
    <script src="/static/external/pie.js" type="text/javascript"></script>
    <script src="/static/external/black.js" type="text/javascript"></script>
    <link rel="stylesheet" href="/static/report.css">
</head>
<body>
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <ul class="nav navbar-nav">
          <h2><img src="/static/logo-report.png" alt="" width="160px" /></h2>
        </ul>
        <ul class="nav navbar-nav navbar-right">
           <li><a href="/"><span class="glyphicon glyphicon-home"></span> Home</a></li>
           <li><a href="/dashboard"><span class="glyphicon glyphicon-th"></span> Dashboard</a></li>
           <li class="dropdown">
              <a class="dropdown-toggle" type="button" data-toggle="dropdown">
              <span class="glyphicon glyphicon-user"></span> {% if session.get('email') %}
                {{ session.get('name').title() | e }}
                {% else %}
                Guest 
                {% endif %}
              <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/logout"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
              </ul>
            </li>
           
        </ul>
      </div>
    </nav>
    <div id="wrapper">
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="#">
                        Scan Report
                    </a>
                </li>
                <li>
                    <a id="goman" href="#man">Manifest Analysis</a>
                </li>
                <li>
                    <a id="gosec" href="#sec">Security Analysis</a>
                    <ul>
                    {% for vuln in vulns_high_level %}
                      {% set vul_id = vuln['vul_id'] %}
                      {% set name = vuln['name'] %}
                      {% set count = vuln['count'] %}
                      <li>
                        <a id="gocryp" href="#{{ vul_id | e }}">{{ name | e}} 
                          <span class="badge">{{ count | e}}</span>
                        </a>
                      </li>
                    {% endfor %}
                    </ul>
                </li>
            </ul>
        </div>

        <div id="page-content-wrapper">

            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-12">

                    <div id="togglebutton">
                        <a href="#menu-toggle" class="btn" id="menu-toggle" ><span class="glyphicon glyphicon-resize-horizontal"></span></a>
                    </div>

                    <ul id="tab" class="nav nav-tabs">
                      <li class="active"><a data-toggle="tab" href="#home" id="hometab">Stats</a></li>
                      <li><a data-toggle="tab" href="#menu1" id="menu1tab">Analysis Summary</a></li>
                      <li><a data-toggle="tab" href="#menu3" id="menu2tab">Quick Results</a></li>
                      <li><a data-toggle="tab" href="#menu2" id="menu3tab">Detailed App Analysis</a></li>
                      <li><a data-toggle="tab" href="#menu4" id="menu4tab">Compare Reports</a></li>
                      <li style="float:right" class="dropdown">
                        <a class="dropdown-toggle" type="button" data-toggle="dropdown">
                        <span class="glyphicon glyphicon-hdd"></span>
                          Download
                        <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                          <li><a href="/download?id={{scan_id|e}}&format=json" class="glyphicon glyphicon-download"> json</a></li>
                          <li><a href="/download?id={{scan_id|e}}&format=xml" class="glyphicon glyphicon-download"> xml</a></li>
                        </ul>
                      </li>
                    </ul>
                    
                    <div class="tab-content">
                    
                      <div id="menu1" class="tab-pane fade">
                        <ul class="nav nav-pills">
                          <li class="active"><a data-toggle="pill" href="#bugsev">Bugs by severity</a></li>
                          <li><a data-toggle="pill" href="#bugtyp">Bugs by type</a></li>
                        </ul>
                        
                        <div class="tab-content">
                          <div id="bugsev" class="tab-pane fade in active">
                           <div id="chart" style="width: 100%; height: 400px; background-color: #000000;" ></div>
                          </div>
                          <div id="bugtyp" class="tab-pane fade">
                            <div id="chart2" style="width: 100%; height: 400px; background-color: #000000;" ></div>
                          </div>
                        </div>
                      </div>

                      <div id="menu4" class="tab-pane fade">
                        <script>document.getElementById("menu-toggle").style.visibility="hidden";</script>
                        <div class="modal-dialog" style="width: 800px">
                          <!-- Modal content-->
                          <div class="modal-content">
                            <div class="modal-body text-center" style="padding:40px 50px;">
                              <label>Select upto 3 Scans only</label>
                              <form method="POST" action="/compare_reports" role="form" enctype="multipart/form-data"> 
                                <div class="container-fluid" id="history">
                                  <table id="compare_history_table" class="display" style="width:100%" data-pagination="true"></table>
                                </div>
                                <br /><br />
                                <button type="submit" class="btn btn-block btn-primary" name="upload" value="upload" id="scan-now">
                                  <strong>Compare</strong>
                                </button>            
                              </form> 
                            </div>
                          </div>
                        </div>
                      </div>
                      <script>
                          $(document).ready(function(){
                            var scan_history = {};
                            var url = "/scan_history?id={{scan_id|e}}";
                            
                            $.getJSON(url,function(data){
                              scan_history = data;
                               console.log(scan_history);
                              
                              $('#compare_history_table').DataTable({
                                data: scan_history,
                                  columns: [
                                  {
                                      title: 'App Name',
                                      render: function ( data, type, row ) { return row['package_name'];}
                                  }, {
                                      title: 'Version',
                                      render: function ( data, type, row ) { return row['package_version'];}
                                  }, {
                                      title: 'Last Scan',
                                      render: function ( data, type, row ) { return row['time_of_scan'];}
                                  }, {
                                      title: 'Select',
                                      render: function ( data, type, row ) { return '<div class="checkbox"><label><input name="scan_'+row['scan_id']+'" type="checkbox" value="'+row['scan_id']+'"></label>';}
                                  }]
                              });

                            });
                          });
                      </script>

                       <div id="menu3" class="tab-pane fade">
                       <script>document.getElementById("menu-toggle").style.visibility="hidden";</script>
                        <ul class="nav nav-pills">
                          <li class="active"><a data-toggle="pill" href="#bughigh">High</a></li>
                          <li><a data-toggle="pill" href="#bugmed">Medium</a></li>
                          <li><a data-toggle="pill" href="#buglow">Low</a></li>
                           <li><a data-toggle="pill" href="#buginfo">Info</a></li>
                        </ul>
                        
                        <div class="tab-content">
                          <div id="bughigh" class="tab-pane fade in active">
                                <div class="bg-white">
                                      <table class="table table-hover table-bordered " >
                                        <style>
                                            th {
                                              background-color:  #4f4f4f ;
                                              color: white;
                                            }

                                            table {
                                              border-collapse:collapse; 
                                              table-layout:fixed; 
                                              width:310px; 
                                              margin-top: 10px; 
                                              background: #c8c8c8; 
                                            }

                                            table td {
                                              word-wrap:break-word;
                                            }

                                        </style>
                                        <thead>
                                          <tr>
                                            <th>Type</th>
                                            <th>File</th>
                                            <th>Line</th>
                                            <th>Snippet</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          {% for row in bugs_results_high %}
                                            {% set name = row[0] %}
                                            {% set filename = row[1].split('output/')[1] %}
                                            {% set line_no = row[2] %}
                                            {% set snippet = row[3] %}

                                            <tr>
                                              <td>{{ name | e }}</td>
                                              <td>
                                                {% autoescape false %}
                                                  {{ filename | replace("/", ".") | e }}
                                                {% endautoescape %}
                                              </td>
                                              <td>{{ line_no | e }}</td>
                                              <td>
                                                <font face="monospace" size=2>
                                                  {{ snippet | e }}
                                                </font>
                                              </td>
                                            </tr>
                                          {% endfor %}
                                        </tbody>
                                     </table>
                                </div>                     
                          </div>
                          <div id="bugmed" class="tab-pane fade">
                            <div class="bg-white">
                                        <table class="table table-hover table-bordered " >
                                        <style>
                                        th {
                                                background-color:  #4f4f4f ;
                                                color: white;
                                            }

                                            table {border-collapse:collapse; table-layout:fixed; width:310px; margin-top: 10px; background: #c8c8c8; }
                                             table td {word-wrap:break-word;}

                                        </style>
                                        <thead>
                                        <tr>
                                        <th>Type</th>
                                        <th>File</th>
                                        <th>Line</th>
                                        <th>Snippet</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tbody>
                                          {% for row in bugs_results_medium %}
                                            {% set name = row[0] %}
                                            {% set filename = row[1].split('output/')[1] %}
                                            {% set line_no = row[2] %}
                                            {% set snippet = row[3] %}

                                            <tr>
                                              <td>{{ name | e }}</td>
                                              <td>
                                                {% autoescape false %}
                                                  {{ filename | replace("/", ".") | e }}
                                                {% endautoescape %}
                                              </td>
                                              <td>{{ line_no | e }}</td>
                                              <td>
                                                <font face="monospace" size=2>
                                                  {{ snippet | e }}
                                                </font>
                                              </td>
                                            </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                </div> 
                          </div>
                           <div id="buglow" class="tab-pane fade">
                                <div class="bg-white">
                                        <table class="table table-hover table-bordered " >
                                        <style>
                                        th {
                                                background-color:  #4f4f4f ;
                                                color: white;
                                            }

                                            table {border-collapse:collapse; table-layout:fixed; width:310px; margin-top: 10px; background: #c8c8c8; }
                                             table td {word-wrap:break-word;}

                                        </style>
                                        <thead>
                                        <tr>
                                        <th>Type</th>
                                        <th>File</th>
                                        <th>Line</th>
                                        <th>Snippet</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                          {% for row in bugs_results_low %}
                                            {% set name = row[0] %}
                                            {% set filename = row[1].split('output/')[1] %}
                                            {% set line_no = row[2] %}
                                            {% set snippet = row[3] %}

                                            <tr>
                                              <td>{{ name | e }}</td>
                                              <td>
                                                {% autoescape false %}
                                                  {{ filename | replace("/", ".") | e }}
                                                {% endautoescape %}
                                              </td>
                                              <td>{{ line_no | e }}</td>
                                              <td>
                                                <font face="monospace" size=2>
                                                  {{ snippet | e }}
                                                </font>
                                              </td>
                                            </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                </div> 
                          </div>
                           <div id="buginfo" class="tab-pane fade">
                                <div class="bg-white">
                                        <table class="table table-hover table-bordered " >
                                        <style>
                                        th {
                                                background-color:  #4f4f4f ;
                                                color: white;
                                            }

                                            table {border-collapse:collapse; table-layout:fixed; width:310px; margin-top: 10px; background: #c8c8c8; }
                                             table td {word-wrap:break-word;}

                                        </style>
                                        <thead>
                                        <tr>
                                        <th>Type</th>
                                        <th>File</th>
                                        <th>Line</th>
                                        <th>Snippet</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                          {% for row in bugs_results_info %}
                                            {% set name = row[0] %}
                                            {% set filename = row[1].split('output/')[1] %}
                                            {% set line_no = row[2] %}
                                            {% set snippet = row[3] %}

                                            <tr>
                                              <td>{{ name | e }}</td>
                                              <td>
                                                {% autoescape false %}
                                                  {{ filename | replace("/", ".") | e }}
                                                {% endautoescape %}
                                              </td>
                                              <td>{{ line_no | e }}</td>
                                              <td>
                                                <font face="monospace" size=2>
                                                  {{ snippet | e }}
                                                </font>
                                              </td>
                                            </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                </div>                     
                          </div>

                        </div>
                      </div>

                  <div id="home" class="tab-pane fade in active">
                    <script>$("#wrapper").toggleClass("toggled");</script>
                     <div class="row">
                        <div id="chartdiv"></div>
                        <br /><br />
                     </div>
                     <h4 style="padding-left: 30px">Security Health Status : <label id="healthChart_val"></label></h4>
                          <div id="healthChart" style="vertical-align: middle; display: inline-block;"></div>
                        <br /><br />
                    <div class="row">
                        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                            <div class="panel panel-default" >
                                <div class="panel-heading panel-jumbo separator" id="high">
                                    <div class="panel-title">
                                    <h2 class="text-center ng-binding" id="heading">
                                        {{ vuln_count_high[0][0] | e }}
                                    </h2>
                                    </div>
                                </div>
                                <div class="panel-body bg-red" id="high">
                                <h3  class="text-center ng-binding" id="heading">High</h3>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                            <div class="panel panel-default">
                                <div class="panel-heading panel-jumbo separator" id="medium">
                                    <div class="panel-title">
                                        <h2 class="text-center ng-binding" id="heading">
                                            {{ vuln_count_medium[0][0] | e }}
                                        </h2>
                                    </div>
                                </div>
                                <div class="panel-body" id="medium">
                                    <h3 class="text-center ng-binding" id="heading">Medium</h3>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                            <div class="panel panel-default">
                                <div class="panel-heading panel-jumbo separator" id="low">
                                    <div class="panel-title">
                                        <h2 class="text-center ng-binding" id="heading">
                                            {{ vuln_count_low[0][0] | e }}
                                            </h2>
                                    </div>
                                </div>
                                <div class="panel-body" id="low">
                                    <h3  class="text-center ng-binding" id="heading">Low</h3>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                            <div class="panel panel-default" >
                                <div class="panel-heading panel-jumbo separator" id="info">
                                    <div class="panel-title">
                                    <h2 class="text-center ng-binding" id="heading">
                                        {{ vuln_count_info[0][0] | e }}
                                    </h2>
                                    </div>
                                </div>
                                <div class="panel-body bg-red" id="info">
                                <h3  class="text-center ng-binding" id="heading">Info</h3>
                                </div>
                            </div>
                        </div>

                    </div>
                    </div>


                    <div id="menu2" class="tab-pane fade">
                        <div id="pagemargin">
                            <div class="row" id="man">
                            <h2>Manifest Analysis</h2> 
                            </div>
                            <div class="row">
                              {% set min_sdk = manifest_analisys_details[0][0] %}
                              {% set target_sdk = manifest_analisys_details[0][1] %}
                              {% set debuggable = manifest_analisys_details[0][2] %}
                              {% set backup = manifest_analisys_details[0][3] %}

                                <div class="col-sm-6" id="info1">
                                  <div class="row">
                                    <div class="col-sm-8">
                                      <h4>Min SDK</h4>
                                    </div>
                                    <h4>
                                         {{ min_sdk | e }}
                                    </h4>
                                  </div>
                                  <div class="row">
                                    <div class="col-sm-8">
                                      <h4>Target SDK</h4>
                                    </div>
                                    <h4>
                                      {{ target_sdk | e }}
                                    </h4>
                                  </div>
                                </div>
                                <div class="col-sm-6" id="info2">
                                <!-- <div id ="info2"> -->
                                  <div class="row">
                                    <div class="col-sm-8">
                                      <h4>Android debuggable</h4>
                                    </div>
                                    <h4>
                                      {{ debuggable | e }}
                                    </h4>
                                  </div>
                                  <div class="row">
                                    <div class="col-sm-8">
                                      <h4>Backup</h4>
                                    </div>
                                    <h4>
                                      {{ backup | e }}
                                    </h4>
                                  </div>
                                </div>
                            </div>
                            <div class="row" id="sdk">
                              <div class="col-sm-4" id="raws">
                                <div class="row bg-activities">
                                    <div class="col-sm-4" id="thingies">
                                         <div class="col-sm-9">
                                            <h1>
                                              <span class="glyphicon glyphicon-duplicate"></span><br />{{ exported_activities[0] | e }}
                                            </h1>
                                        </div>
                                    </div>
                                    <div class="col-sm-8 text-left ">
                                        <h3>Exported<br />Activity</h3>
                                    </div>
                                     <button type="button" class="btn btn-block" data-toggle="collapse" data-target="#activity" aria-expanded="false" aria-controls="activity" id="view">View</button>
                                    <div class ="collapse" id="activity">
                                      <div class="card card-block">
                                        <table class="table table-hover table-bordered " >
                                          <style>
                                            table {
                                              border-collapse:collapse; 
                                              table-layout:fixed; 
                                              width:310px;
                                              background: #000000; 
                                            }
                                            table td {
                                              word-wrap:break-word;
                                              background: #CCC;
                                            }
                                          </style>
                                          <tbody>
                                            {% for activity in exported_activities[1] %}
                                              <tr><td>{{ activity[0] | e }}</tr></td>
                                            {% endfor %}
                                          </tbody>
                                        </table>
                                    </div>
                                  </div>  
                                </div>
                              </div>
                              <div class="col-sm-4" id="raws">
                                  <div class="row bg-activities">
                                      <div class="col-sm-4" id="thingies">
                                          <div class="col-sm-9">
                                              <h1><span class="glyphicon glyphicon-send"></span><br />{{ exported_services[0] | e }}
                                              </h1>
                                          </div>
                                      </div>
                                      <div class="col-sm-8 text-left ">
                                          <h3>Exported<br>Services</h3>
                                      </div>
                                      <button type="button" class="btn btn-block" data-toggle="collapse" data-target="#service" aria-expanded="false" aria-controls="service" id="view">View</button>
                                      <div class="collapse" id="service">
                                          <div class="card card-block">
                                            <table class="table table-hover table-bordered " >
                                              <style>
                                                table {
                                                  border-collapse:collapse; 
                                                  table-layout:fixed; 
                                                  width:310px;
                                                  background: #000000; 
                                                }
                                                table td {
                                                  word-wrap:break-word;
                                                  background: #CCC;
                                                }
                                              </style>
                                              <tbody>
                                                {% for service in exported_services[1] %}
                                                  <tr><td>{{ service[0] | e }}</tr></td>
                                                {% endfor %}
                                              </tbody>
                                            </table>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4" id="raws">
                                  <div class="row bg-activities">
                                      <div class="col-sm-4" id="thingies">
                                          <div class="col-sm-9">
                                              <h1><span class="glyphicon glyphicon-transfer"></span><br />{{ exported_providers[0] | e }}
                                          </h1>
                                          </div>
                                      </div>
                                      <div class="col-sm-8 text-left ">
                                          <h3>Exported<br>Providers</h3>
                                      </div>
                                      <button type="button" class="btn btn-block" data-toggle="collapse" data-target="#provider" aria-expanded="false" aria-controls="provider" id="view">View</button>
                                          <div class="collapse" id="provider">
                                          <div class="card card-block">
                                            <table class="table table-hover table-bordered " >
                                              <style>
                                                table {
                                                  border-collapse:collapse; 
                                                  table-layout:fixed; 
                                                  width:310px;
                                                  background: #000000; 
                                                }
                                                table td {
                                                  word-wrap:break-word;
                                                  background: #CCC;
                                                }
                                              </style>
                                              <tbody>
                                                {% for provider in exported_providers[1] %}
                                                  <tr><td>{{ provider[0] | e }}</td></tr>
                                                {% endfor %}
                                              </tbody>
                                            </table>
                                          </div>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                                <div class="row" id="permissions">
                                    <div class="col-sm-6" id="raws">
                                      <div class="row bg-activities">
                                          <div class="col-sm-4" id="thingies">
                                              <div class="col-sm-9">
                                                  <h1><span class="glyphicon glyphicon-list-alt"></span><br />{{ apk_permissions[0] | e }}
                                              </h1>
                                              </div>
                                          </div>
                                          <div class="col-sm-8 text-left ">
                                              <h3>APK<br>Permissions</h3>
                                          </div>
                                          <button type="button" class="btn btn-block" data-toggle="collapse" data-target="#perms" aria-expanded="false" aria-controls="perms" id="view">View</button>
                                              <div class="collapse" id="perms">
                                              <div class="card card-block">
                                                <table class="table table-hover table-bordered " >
                                                  <style>
                                                    table {
                                                      border-collapse:collapse; 
                                                      table-layout:fixed; 
                                                      width:310px;
                                                      background: #000000; 
                                                    }
                                                    table td {
                                                      word-wrap:break-word;
                                                      background: #CCC;
                                                    }
                                                  </style>
                                                  <tbody>
                                                    {% for perm in apk_permissions[1] %}
                                                      <tr><td>{{ perm[0] | e }}</td></tr>
                                                    {% endfor %}
                                                  </tbody>
                                                </table>
                                              </div>
                                            </div>
                                          </div>
                                      </div>
                                    <div class="col-sm-6" id="raws">
                                      <div class="row bg-activities">
                                          <div class="col-sm-4" id="thingies">
                                              <div class="col-sm-9">
                                                  <h1><span class="glyphicon glyphicon-list-alt"></span><br />{{ apk_receivers[0] | e }}
                                              </h1>
                                              </div>
                                          </div>
                                          <div class="col-sm-8 text-left ">
                                              <h3>Broadcast<br>Receivers</h3>
                                          </div>
                                          <button type="button" class="btn btn-block" data-toggle="collapse" data-target="#receivers" aria-expanded="false" aria-controls="receivers" id="view">View</button>
                                              <div class="collapse" id="receivers">
                                              <div class="card card-block">
                                                <table class="table table-hover table-bordered " >
                                                  <style>
                                                    table {
                                                      border-collapse:collapse; 
                                                      table-layout:fixed; 
                                                      width:310px;
                                                      background: #000000; 
                                                    }
                                                    table td {
                                                      word-wrap:break-word;
                                                      background: #CCC;
                                                    }
                                                  </style>
                                                  <tbody>
                                                    {% for receiver in apk_receivers[1] %}
                                                      <tr><td>{{ receiver[0] | e }}</td></tr>
                                                    {% endfor %}
                                                  </tbody>
                                                </table>
                                              </div>
                                            </div>
                                          </div>
                                      </div>
                                    </div>
                                
                                <div class="row" id="sec">
                                    <h2>Security Analysis</h2>
                                </div>
                                {% for vuln in all_vulns_details %}
                                  <div>
                                      <div >
                                        <h3><span class="label label-orange" id='{{ vuln | e }}'>
                                          {{ all_vulns_details[vuln][0][0] | e }}
                                        </span></h3>
                                        <h4><span class="label"> 
                                            {{ all_vulns_details[vuln][0][2] | e }}</span></h4>
                                      </div>
                                      <div class="bg-white">
                                      {{ all_vulns_details[vuln][0][1] | e }}
                                      </div>
                                        <div class="bg-white">
                                          <table class="table table-hover table-bordered " >
                                          <style>
                                            th {
                                              background-color:  #4f4f4f ;
                                              color: white;
                                            }

                                            table {
                                              border-collapse:collapse; table-layout:fixed; width:310px; 
                                              margin-top: 10px; background: #c8c8c8; 
                                            }
                                            table td {word-wrap:break-word;}
                                          </style>
                                          <thead>
                                          <tr>
                                          <th>File</th>
                                          <th>Line</th>
                                          <th>Snippet</th>
                                          </tr>
                                        </thead>
                                      <tbody>
                                        {% for row in all_vulns_details[vuln][1] %}
                                          {% set filename = row[0].split('output/')[1] %}
                                          {% set line_no = row[1] %}
                                          {% set snippet = row[2] %}
                                        <tr>
                                          <td>
                                            {% autoescape false %}
                                              {{ filename | replace("/", ".") | e }}
                                            {% endautoescape %}
                                          </td>
                                          <td>{{ line_no | e }}</td>
                                          <td><font face="monospace" size=2>{{ snippet | e }}</font></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                  </table>
                                 </div>
                              {% endfor %}
                            </div>
                          </div>
                       </div>
                </div>
            </div>
        </div>
    </div>
<script>

function dynamic(arr)
{

  var chartData=[];
  for(var i=0;i<arr.length;i++)
    {
     chartData[i]=arr[i]
    }

// console.log(chartData);
var chart = AmCharts.makeChart("chartdiv", {
  type: "serial",
  dataProvider: chartData,
  addClassNames: true,
  startDuration: 1,
  color: "#FFFFFF",
  marginLeft: 0,

  categoryField: "vulnerability",
  categoryAxis: {
    autoGridCount: false,
    gridCount: 50,
    gridAlpha: 0.1,
    gridColor: "#FFFFFF",
    axisColor: "#555555",
  },

  valueAxes: [{
    id: "a1",
    title: "No of vulnerabilities",
    gridAlpha: 0,
    axisAlpha: 0
  },{
    id: "a2",
    position: "right",
    gridAlpha: 0,
    axisAlpha: 0,
    labelsEnabled: false
  }],
  graphs: [{
    id: "g1",
    valueField:  "vulnerabilities",
    title:  "vulnerabilities count",
    type:  "column",
    fillAlphas:  0.9,
    valueAxis:  "a1",
    balloonText:  "[[value]] vulnerabilities",
    legendValueText:  "[[value]] vul",
    legendPeriodValueText:  "total: [[value.sum]] vul",
    lineColor:  "#263138",
    alphaField:  "alpha",
  },{
    id: "g2",
    valueField: "severity",
    classNameField: "bulletClass",
    title: "severity",
    type: "line",
    valueAxis: "a2",
    lineColor: "#786c56",
    lineThickness: 1,
    legendValueText: "[[description]]",
    descriptionField: "severityvalue",
    bullet: "round",
    bulletSizeField: "size",
    bulletBorderColor: "#786c56",
    bulletBorderAlpha: 1,
    bulletBorderThickness: 2,
    bulletColor: "#000000",
    labelText: "[[severityvalue]]",
    labelPosition: "right",
    balloonText: "severity:[[value]]",
    showBalloon: true,
    animationPlayed: true,
  }],

  chartCursor: {
    zoomable: false,
    cursorAlpha: 0,
    valueBalloonsEnabled: false
  },
  legend: {
    bulletType: "round",
    equalWidths: false,
    valueWidth: 120,
    useGraphSettings: true,
    color: "#FFFFFF"
  }
});
}

var data=[];
{% for data_ele in bugs_by_severity %}
data.push({{ data_ele | safe  }});
{% endfor %}
document.getElementById("chartdiv").innerHTML = dynamic(data);
</script>
<script type="text/javascript">
  
  AmCharts.makeChart("chart",
    {
      "type": "pie",
      "angle": 12,
      "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>",
      "depth3D": 15,
      "titleField": "category",
      "valueField": "column-1",
      "theme": "black",
      "allLabels": [],
      "balloon": {},
      "legend": {
      "enabled": true,
      "align": "center",
      "markerType": "circle"
      },
      "titles": [],
      "dataProvider": [
      {
        "category": "High",
        "column-1": {{ vuln_count_high[0][0] | safe }}
      },
      {
      "category": "Medium",
      "column-1": {{ vuln_count_medium[0][0] | safe }}
      },
      {
      "category": "Low",
      "column-1": {{ vuln_count_low[0][0] | safe }}
       }
          ]
        }
      );
</script>
<script type="text/javascript">
function dynamic2(arr)
{
  var chartData=[];
  for(var i=0;i<arr.length;i++)
    {
     chartData[i]=arr[i]
    }

  var chart =AmCharts.makeChart("chart2",
    {
      "type": "pie",
      "angle": 12,
      "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>",
      "depth3D": 15,
      "titleField": "category",
      "valueField": "column-1",
      "theme": "black",
      "allLabels": [],
      "balloon": {},
      "legend": {
      "enabled": true,
      "align": "center",
      "markerType": "circle"
      },
      "titles": [],
      "dataProvider": chartData
        });
}

var data2 = [];
{% for data_ele in bugs_by_type %}
data2.push({{ data_ele | safe  }});
{% endfor %}
 document.getElementById("chart2").innerHTML = dynamic2(data2);

var health = parseInt({{ vuln_count_high[0][0] | e }})*20+parseInt({{ vuln_count_medium[0][0] | e }})*10;
health = health/(health+parseInt({{ vuln_count_low[0][0] | e }})*5)*100;
health = (100 - health).toFixed(2);

// console.log(health);
AmCharts.makeChart( "healthChart", {
  "type": "serial",
  "dataProvider": [ {
    "x": 1,
    "y": 100
  } ],
  "categoryField": "x",
  "rotate": true,
  "autoMargins": false,
  "marginLeft": 0,
  "marginRight": 0,
  "marginTop": 0,
  "marginBottom": 0,
  "graphs": [ {
    "valueField": "y",
    "type": "column",
    "fillAlphas": 1,
    "fillColors": [ "#ef4b2b","#1eb719" ],
    "gradientOrientation": "horizontal",
    "lineColor": "#FFFFFF",
    "showBalloon": false
  } ],
  "valueAxes": [ {
    "gridAlpha": 0,
    "axisAlpha": 0,
    "stackType": "100%",
    "guides": [ {
      "value": health,
      "lineAlpha": 1,
      "above": true
    } ]
  } ],
  "categoryAxis": {
    "gridAlpha": 0,
    "axisAlpha": 0
  }
});

document.getElementById('healthChart_val').innerHTML = health+" %";
</script>

<script>

    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    $("#menu3tab").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled",false);
    });
    $("#hometab").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled",true);
    });
    $("#menu1tab").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled",true);
    });
    $("#menu2tab").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled",true);
    });
    $("#menu4tab").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled",true);
    });
    </script>


    <script type="text/javascript">

    $(document).ready(function(){
      // Add smooth scrolling to all links in navbar + footer link
      $("#gocryp,#goman,#gosec").on('click', function(event) {
        // Make sure this.hash has a value before overriding default behavior
        if (this.hash !== "") {
          // Prevent default anchor click behavior
          event.preventDefault();

          // Store hash
          var hash = this.hash;

          // Using jQuery's animate() method to add smooth page scroll
          // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
          $('html, body').animate({
            scrollTop: $(hash).offset().top
          }, 900, function(){
       
            // Add hash (#) to URL when done scrolling (default click behavior)
            window.location.hash = hash;
          });
        } // End if
    });
})

</script><br/><br/>
    <!-- Footer -->
    {% extends "footer.html" %}
    <!-- Footer -->
</body>
</html>
